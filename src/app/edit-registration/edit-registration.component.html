<div class="edit-registration-container">
  <div class="edit-registration-card">
    <div class="header-section">
      <div class="header-left">
        <h1 class="heading">Student Registration Details</h1>
        <button type="button" class="back-to-login" (click)="navigateToLogin()">
          Back to Login
        </button>
      </div>
      <button
        *ngIf="!isEditMode"
        type="button"
        class="btn-edit"
        (click)="enableEditMode()"
      >
        Edit Details
      </button>
    </div>

    <form [formGroup]="registrationForm">
      <!-- Child Info Section -->
      <div class="form-section">
        <h2 class="section-title">Child Information</h2>
        <div class="form-row">
          <div class="form-group">
            <label>First Name</label>
            <input
              type="text"
              formControlName="childFirstName"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('childFirstName')"
            />
            <div *ngIf="isFieldInvalid('childFirstName')" class="error-message">
              First name is required
            </div>
          </div>
          <div class="form-group">
            <label>Middle Name</label>
            <input
              type="text"
              formControlName="childMiddleName"
              class="form-control"
            />
          </div>
          <div class="form-group">
            <label>Last Name</label>
            <input
              type="text"
              formControlName="childLastName"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('childLastName')"
            />
            <div *ngIf="isFieldInvalid('childLastName')" class="error-message">
              Last name is required
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Gender</label>
            <select
              formControlName="gender"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('gender')"
            >
              <option value="">Select Gender</option>
              <option *ngFor="let option of genderOptions" [value]="option">
                {{ option }}
              </option>
            </select>
            <div *ngIf="isFieldInvalid('gender')" class="error-message">
              Gender is required
            </div>
          </div>
          <div class="form-group">
            <label>Date of Birth</label>
            <input
              type="date"
              formControlName="dateOfBirth"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('dateOfBirth')"
            />
            <div *ngIf="isFieldInvalid('dateOfBirth')" class="error-message">
              Date of birth is required
            </div>
          </div>
          <div class="form-group">
            <label>Place of Birth</label>
            <input
              type="text"
              formControlName="placeOfBirth"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('placeOfBirth')"
            />
            <div *ngIf="isFieldInvalid('placeOfBirth')" class="error-message">
              Place of birth is required
            </div>
          </div>
        </div>
      </div>

      <!-- Parent/Guardian Info Section -->
      <div class="form-section">
        <h2 class="section-title">Parent/Guardian Information</h2>
        <div class="form-row">
          <div class="form-group">
            <label>First Name</label>
            <input
              type="text"
              formControlName="parentFirstName"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('parentFirstName')"
            />
            <div
              *ngIf="isFieldInvalid('parentFirstName')"
              class="error-message"
            >
              First name is required
            </div>
          </div>
          <div class="form-group">
            <label>Middle Name</label>
            <input
              type="text"
              formControlName="parentMiddleName"
              class="form-control"
            />
          </div>
          <div class="form-group">
            <label>Last Name</label>
            <input
              type="text"
              formControlName="parentLastName"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('parentLastName')"
            />
            <div *ngIf="isFieldInvalid('parentLastName')" class="error-message">
              Last name is required
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Relationship</label>
            <select
              formControlName="relationship"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('relationship')"
            >
              <option value="">Select Relationship</option>
              <option
                *ngFor="let option of relationshipOptions"
                [value]="option"
              >
                {{ option }}
              </option>
            </select>
            <div *ngIf="isFieldInvalid('relationship')" class="error-message">
              Relationship is required
            </div>
          </div>
          <div class="form-group">
            <label>Email</label>
            <input
              type="email"
              formControlName="parentEmail"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('parentEmail')"
            />
            <div *ngIf="isFieldInvalid('parentEmail')" class="error-message">
              Valid email is required
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group full-width">
            <label>Address Line 1</label>
            <input
              type="text"
              formControlName="parentAddress1"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('parentAddress1')"
            />
            <div *ngIf="isFieldInvalid('parentAddress1')" class="error-message">
              Address is required
            </div>
          </div>
          <div class="form-group full-width">
            <label>Address Line 2</label>
            <input
              type="text"
              formControlName="parentAddress2"
              class="form-control"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Country</label>
            <input
              type="text"
              formControlName="parentCountry"
              class="form-control"
              [attr.disabled]="true"
            />
          </div>
          <div class="form-group">
            <label>State</label>
            <select
              formControlName="parentState"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('parentState')"
            >
              <option value="">Select State</option>
              <option *ngFor="let state of usStates" [value]="state.name">
                {{ state.name }}
              </option>
            </select>
            <div *ngIf="isFieldInvalid('parentState')" class="error-message">
              State is required
            </div>
          </div>
          <div class="form-group">
            <label>City</label>
            <input
              type="text"
              formControlName="parentCity"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('parentCity')"
            />
            <div *ngIf="isFieldInvalid('parentCity')" class="error-message">
              City is required
            </div>
          </div>
          <div class="form-group">
            <label>Zip Code</label>
            <input
              type="text"
              formControlName="parentZipCode"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('parentZipCode')"
            />
            <div *ngIf="isFieldInvalid('parentZipCode')" class="error-message">
              Zip code is required
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Phone Type</label>
            <select
              formControlName="parentPhoneType"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('parentPhoneType')"
            >
              <option value="">Select Phone Type</option>
              <option *ngFor="let option of phoneTypeOptions" [value]="option">
                {{ option }}
              </option>
            </select>
            <div
              *ngIf="isFieldInvalid('parentPhoneType')"
              class="error-message"
            >
              Phone type is required
            </div>
          </div>
          <div class="form-group">
            <label>Phone Number</label>
            <div class="phone-input-wrapper">
              <span class="country-code">+1 (US)</span>
              <input
                type="text"
                formControlName="parentPhoneNumber"
                class="form-control"
                placeholder="(555) 555-5555"
                maxlength="14"
                (keypress)="onPhoneKeypress($event, 'parentPhoneNumber')"
                [class.is-invalid]="isFieldInvalid('parentPhoneNumber')"
              />
            </div>
            <div
              *ngIf="isFieldInvalid('parentPhoneNumber')"
              class="error-message"
            >
              Phone number must be 10 digits
            </div>
          </div>
          <div class="form-group">
            <label>Alternate Phone Type</label>
            <select
              formControlName="parentAlternatePhoneType"
              class="form-control"
            >
              <option value="">Select Phone Type</option>
              <option *ngFor="let option of phoneTypeOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </div>
          <div class="form-group">
            <label>Alternate Phone Number</label>
            <input
              type="text"
              formControlName="parentAlternatePhoneNumber"
              class="form-control"
              placeholder="(555) 555-5555"
              maxlength="14"
              (keypress)="onPhoneKeypress($event, 'parentAlternatePhoneNumber')"
            />
          </div>
        </div>
      </div>

      <!-- Medical Info Section -->
      <div class="form-section">
        <h2 class="section-title">Medical Information</h2>
        <div class="form-row">
          <div class="form-group">
            <label>Physician First Name</label>
            <input
              type="text"
              formControlName="physicianFirstName"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('physicianFirstName')"
            />
            <div
              *ngIf="isFieldInvalid('physicianFirstName')"
              class="error-message"
            >
              First name is required
            </div>
          </div>
          <div class="form-group">
            <label>Physician Last Name</label>
            <input
              type="text"
              formControlName="physicianLastName"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('physicianLastName')"
            />
            <div
              *ngIf="isFieldInvalid('physicianLastName')"
              class="error-message"
            >
              Last name is required
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group full-width">
            <label>Address Line 1</label>
            <input
              type="text"
              formControlName="medicalAddress1"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('medicalAddress1')"
            />
            <div
              *ngIf="isFieldInvalid('medicalAddress1')"
              class="error-message"
            >
              Address is required
            </div>
          </div>
          <div class="form-group full-width">
            <label>Address Line 2</label>
            <input
              type="text"
              formControlName="medicalAddress2"
              class="form-control"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Country</label>
            <input
              type="text"
              formControlName="medicalCountry"
              class="form-control"
              [attr.disabled]="true"
            />
          </div>
          <div class="form-group">
            <label>State</label>
            <select
              formControlName="medicalState"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('medicalState')"
            >
              <option value="">Select State</option>
              <option *ngFor="let state of usStates" [value]="state.name">
                {{ state.name }}
              </option>
            </select>
            <div *ngIf="isFieldInvalid('medicalState')" class="error-message">
              State is required
            </div>
          </div>
          <div class="form-group">
            <label>City</label>
            <input
              type="text"
              formControlName="medicalCity"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('medicalCity')"
            />
            <div *ngIf="isFieldInvalid('medicalCity')" class="error-message">
              City is required
            </div>
          </div>
          <div class="form-group">
            <label>Zip Code</label>
            <input
              type="text"
              formControlName="medicalZipCode"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('medicalZipCode')"
            />
            <div *ngIf="isFieldInvalid('medicalZipCode')" class="error-message">
              Zip code is required
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Phone Type</label>
            <select
              formControlName="medicalPhoneType"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('medicalPhoneType')"
            >
              <option value="">Select Phone Type</option>
              <option *ngFor="let option of phoneTypeOptions" [value]="option">
                {{ option }}
              </option>
            </select>
            <div
              *ngIf="isFieldInvalid('medicalPhoneType')"
              class="error-message"
            >
              Phone type is required
            </div>
          </div>
          <div class="form-group">
            <label>Phone Number</label>
            <div class="phone-input-wrapper">
              <span class="country-code">+1 (US)</span>
              <input
                type="text"
                formControlName="medicalPhoneNumber"
                class="form-control"
                placeholder="(555) 555-5555"
                maxlength="14"
                (keypress)="onPhoneKeypress($event, 'medicalPhoneNumber')"
                [class.is-invalid]="isFieldInvalid('medicalPhoneNumber')"
              />
            </div>
            <div
              *ngIf="isFieldInvalid('medicalPhoneNumber')"
              class="error-message"
            >
              Phone number must be 10 digits
            </div>
          </div>
          <div class="form-group">
            <label>Alternate Phone Type</label>
            <select
              formControlName="medicalAlternatePhoneType"
              class="form-control"
            >
              <option value="">Select Phone Type</option>
              <option *ngFor="let option of phoneTypeOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </div>
          <div class="form-group">
            <label>Alternate Phone Number</label>
            <input
              type="text"
              formControlName="medicalAlternatePhoneNumber"
              class="form-control"
              placeholder="(555) 555-5555"
              maxlength="14"
              (keypress)="
                onPhoneKeypress($event, 'medicalAlternatePhoneNumber')
              "
            />
          </div>
        </div>
      </div>

      <!-- Care Facility Info Section -->
      <div class="form-section">
        <h2 class="section-title">Care Facility Information</h2>
        <div class="form-row">
          <div class="form-group full-width">
            <label>Care Facility Name</label>
            <input
              type="text"
              formControlName="careFacilityName"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('careFacilityName')"
            />
            <div
              *ngIf="isFieldInvalid('careFacilityName')"
              class="error-message"
            >
              Care facility name is required
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group full-width">
            <label>Address Line 1</label>
            <input
              type="text"
              formControlName="careFacilityAddress1"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('careFacilityAddress1')"
            />
            <div
              *ngIf="isFieldInvalid('careFacilityAddress1')"
              class="error-message"
            >
              Address is required
            </div>
          </div>
          <div class="form-group full-width">
            <label>Address Line 2</label>
            <input
              type="text"
              formControlName="careFacilityAddress2"
              class="form-control"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Country</label>
            <input
              type="text"
              formControlName="careFacilityCountry"
              class="form-control"
              [attr.disabled]="true"
            />
          </div>
          <div class="form-group">
            <label>State</label>
            <select
              formControlName="careFacilityState"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('careFacilityState')"
            >
              <option value="">Select State</option>
              <option *ngFor="let state of usStates" [value]="state.name">
                {{ state.name }}
              </option>
            </select>
            <div
              *ngIf="isFieldInvalid('careFacilityState')"
              class="error-message"
            >
              State is required
            </div>
          </div>
          <div class="form-group">
            <label>City</label>
            <input
              type="text"
              formControlName="careFacilityCity"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('careFacilityCity')"
            />
            <div
              *ngIf="isFieldInvalid('careFacilityCity')"
              class="error-message"
            >
              City is required
            </div>
          </div>
          <div class="form-group">
            <label>Zip Code</label>
            <input
              type="text"
              formControlName="careFacilityZipCode"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('careFacilityZipCode')"
            />
            <div
              *ngIf="isFieldInvalid('careFacilityZipCode')"
              class="error-message"
            >
              Zip code is required
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Phone Type</label>
            <select
              formControlName="careFacilityPhoneType"
              class="form-control"
              [class.is-invalid]="isFieldInvalid('careFacilityPhoneType')"
            >
              <option value="">Select Phone Type</option>
              <option *ngFor="let option of phoneTypeOptions" [value]="option">
                {{ option }}
              </option>
            </select>
            <div
              *ngIf="isFieldInvalid('careFacilityPhoneType')"
              class="error-message"
            >
              Phone type is required
            </div>
          </div>
          <div class="form-group">
            <label>Phone Number</label>
            <div class="phone-input-wrapper">
              <span class="country-code">+1 (US)</span>
              <input
                type="text"
                formControlName="careFacilityPhoneNumber"
                class="form-control"
                placeholder="(555) 555-5555"
                maxlength="14"
                (keypress)="onPhoneKeypress($event, 'careFacilityPhoneNumber')"
                [class.is-invalid]="isFieldInvalid('careFacilityPhoneNumber')"
              />
            </div>
            <div
              *ngIf="isFieldInvalid('careFacilityPhoneNumber')"
              class="error-message"
            >
              Phone number must be 10 digits
            </div>
          </div>
        </div>
      </div>

      <!-- Enrollment Program Details Section (Read-only) -->
      <div class="form-section">
        <h2 class="section-title">Enrollment Program Details (Read-only)</h2>
        <div class="form-row">
          <div class="form-group">
            <label>Program Type</label>
            <input
              type="text"
              formControlName="programType"
              class="form-control"
              [attr.disabled]="true"
            />
          </div>
          <div class="form-group">
            <label>Room Type</label>
            <input
              type="text"
              formControlName="roomType"
              class="form-control"
              [attr.disabled]="true"
            />
          </div>
          <div class="form-group">
            <label>Enrollment Date</label>
            <input
              type="date"
              formControlName="enrollmentDate"
              class="form-control"
              [attr.disabled]="true"
            />
          </div>
        </div>
      </div>

      <!-- Error Message Alert -->
      <div
        *ngIf="errorMessage"
        class="error-message-alert"
        [class.success]="errorMessage.includes('successfully')"
      >
        {{ errorMessage }}
      </div>

      <!-- Action Buttons -->
      <div class="form-actions" *ngIf="isEditMode">
        <button type="button" class="btn-primary" (click)="onSaveChanges()">
          Save Changes
        </button>
        <button type="button" class="btn-secondary" (click)="onCancel()">
          Cancel
        </button>
      </div>
    </form>
  </div>
</div>
